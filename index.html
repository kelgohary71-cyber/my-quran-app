<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri+Quran&family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Cairo', sans-serif; 
            background: linear-gradient(135deg, #d1fae5 0%, #fef3c7 50%, #d1fae5 100%); 
            min-height: 100vh; 
            overflow-x: hidden;
        }
        
        .header { 
            background: linear-gradient(to right, #059669, #047857); 
            color: white; 
            padding: 12px; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.15); 
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-title { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 8px; 
            margin-bottom: 4px; 
        }
        .header-title h1 { font-size: 20px; font-weight: bold; }
        .header-subtitle { color: #d1fae5; font-size: 11px; }
        
        .toolbar { 
            background: white; 
            border-bottom: 3px solid #10b981; 
            padding: 10px;
            position: sticky;
            top: 68px;
            z-index: 99;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .toolbar-buttons { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 10px; 
            max-width: 800px; 
            margin: 0 auto; 
        }
        .btn { 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 6px; 
            padding: 10px; 
            border: none; 
            border-radius: 8px; 
            font-size: 14px; 
            font-weight: bold; 
            cursor: pointer; 
            transition: transform 0.2s;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }
        .btn:active { transform: scale(0.95); }
        .btn-search { background: #3B82F6; }
        .btn-fihris { background: #F59E0B; }
        
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 12px;
        }
        
        .progress-bar { 
            background: #d1fae5; 
            border: 2px solid #10b981; 
            border-radius: 8px; 
            padding: 8px; 
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .progress-info { 
            display: flex; 
            justify-content: space-between; 
            font-size: 12px; 
            color: #374151; 
            margin-bottom: 6px; 
            font-weight: 600;
        }
        .progress-track { 
            width: 100%; 
            height: 5px; 
            background: #e5e7eb; 
            border-radius: 3px; 
            overflow: hidden; 
        }
        .progress-fill { 
            height: 100%; 
            background: linear-gradient(to right, #10b981, #f59e0b); 
            transition: width 0.3s; 
        }
        
        .card { 
            background: white; 
            border-radius: 10px; 
            padding: 12px; 
            margin-bottom: 10px; 
            box-shadow: 0 3px 6px rgba(0,0,0,0.12);
        }
        .verse-card { 
            background: #d1fae5; 
            border: 3px solid #10b981; 
        }
        .tafsir-card { 
            background: #d1fae5; 
            border: 3px solid #f59e0b; 
        }
        .card-header { 
            display: flex; 
            align-items: center; 
            gap: 6px; 
            padding-bottom: 6px; 
            border-bottom: 2px solid rgba(0,0,0,0.1); 
            margin-bottom: 8px; 
        }
        .card-icon { 
            width: 28px; 
            height: 28px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-weight: bold; 
            font-size: 14px; 
        }
        .verse-icon { background: linear-gradient(135deg, #10b981, #059669); }
        .tafsir-icon { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .card-title { font-size: 14px; font-weight: bold; }
        .content-box { 
            background: white; 
            border-radius: 8px; 
            padding: 12px; 
            border: 2px solid rgba(0,0,0,0.1); 
        }
        .verse-text { 
            font-family: 'Amiri Quran', 'Amiri', serif; 
            font-size: 20px; 
            line-height: 1.8; 
            text-align: center; 
            color: #1f2937; 
        }
        .tafsir-text { 
            font-size: 14px; 
            line-height: 1.6; 
            color: #374151; 
        }
        
        .nav-buttons { 
            display: flex; 
            gap: 8px; 
            margin-bottom: 10px;
        }
        .nav-btn { 
            flex: 1; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 4px; 
            padding: 12px; 
            border: none; 
            border-radius: 8px; 
            font-size: 14px; 
            font-weight: bold; 
            color: white; 
            cursor: pointer; 
            transition: transform 0.2s;
            box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        }
        .nav-btn:active { transform: scale(0.95); }
        .nav-btn:disabled { opacity: 0.4; cursor: not-allowed; }
        .btn-prev { background: #FF6B35; }
        .btn-share { 
            background: #EC4899; 
            flex: 0 0 auto; 
            padding-left: 16px; 
            padding-right: 16px; 
        }
        .btn-next { background: #8B5CF6; }
        
        .dedication { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); 
            border: 3px solid #fbbf24; 
            border-radius: 8px; 
            padding: 12px; 
            text-align: center; 
            margin-bottom: 8px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        }
        .dedication-text { 
            font-size: 15px; 
            font-weight: 800; 
            color: white; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4); 
            margin-bottom: 6px; 
            line-height: 1.3; 
        }
        .dedication-sub { 
            font-size: 14px; 
            font-weight: bold; 
            color: #fef3c7; 
        }
        
        .footer { 
            background: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%); 
            border: 3px solid #10b981; 
            border-radius: 8px; 
            padding: 12px; 
            text-align: center;
            box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        }
        .footer-name { 
            font-size: 16px; 
            font-weight: 900; 
            color: white; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3); 
            margin-bottom: 4px; 
        }
        .footer-copyright { 
            font-size: 12px; 
            font-weight: bold; 
            color: #d1fae5; 
        }
        
        .modal { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            right: 0; 
            bottom: 0; 
            background: rgba(0,0,0,0.6); 
            z-index: 1000;
            padding: 16px;
        }
        .modal.active { 
            display: flex; 
            align-items: flex-start;
            justify-content: center; 
            padding-top: 80px;
        }
        .modal-content { 
            background: white; 
            border-radius: 10px; 
            padding: 16px; 
            max-width: 90%; 
            width: 500px;
            max-height: calc(100vh - 160px);
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }
        .modal-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 12px;
            position: sticky;
            top: 0;
            background: white;
            padding-bottom: 10px;
            border-bottom: 2px solid #e5e7eb;
            z-index: 10;
        }
        .modal-title { 
            font-size: 16px; 
            font-weight: bold; 
            color: #1f2937; 
        }
        .close-btn { 
            background: #ef4444; 
            color: white; 
            border: none; 
            padding: 5px 12px; 
            border-radius: 5px; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 12px; 
        }
        .search-input { 
            width: 100%; 
            padding: 10px; 
            border: 2px solid #10b981; 
            border-radius: 8px; 
            font-size: 14px; 
            margin-bottom: 12px;
            position: sticky;
            top: 60px;
            background: white;
            z-index: 9;
        }
        .sura-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); 
            gap: 8px; 
        }
        .sura-item { 
            background: linear-gradient(135deg, #fef3c7, #d1fae5); 
            border: 2px solid #f59e0b; 
            border-radius: 8px; 
            padding: 10px; 
            cursor: pointer; 
            transition: transform 0.2s;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .sura-item:active { 
            transform: scale(0.95); 
            background: #fde68a; 
        }
        .sura-name { 
            font-weight: bold; 
            color: #1f2937; 
            margin-bottom: 4px; 
            font-size: 13px; 
        }
        .sura-info { 
            display: flex; 
            justify-content: space-between; 
            font-size: 10px; 
            color: #6b7280; 
        }
        .search-results { 
            max-height: 400px; 
            overflow-y: auto; 
        }
        .search-result-item { 
            background: white; 
            border: 2px solid #10b981; 
            border-radius: 8px; 
            padding: 8px; 
            margin-bottom: 6px; 
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .search-result-item:active { background: #d1fae5; }
        .result-verse { 
            font-weight: bold; 
            color: #047857; 
            margin-bottom: 3px; 
            font-size: 13px; 
        }
        .result-tafsir { 
            font-size: 12px; 
            color: #6b7280; 
        }
        .loading { 
            text-align: center; 
            padding: 40px; 
            font-size: 16px; 
            color: #047857;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-title">
            <span style="font-size: 24px;">ğŸ“–</span>
            <h1>Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©</h1>
        </div>
        <p class="header-subtitle" id="suraName">Ø­ØµØ© Ø§Ù„ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</p>
    </div>

    <div class="toolbar">
        <div class="toolbar-buttons">
            <button class="btn btn-search" onclick="toggleSearch()">
                <span>ğŸ”</span>
                <span>Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†</span>
            </button>
            <button class="btn btn-fihris" onclick="toggleFihris()">
                <span>ğŸ“‹</span>
                <span>ÙÙ‡Ø±Ø³ Ø§Ù„Ø³ÙˆØ±</span>
            </button>
        </div>
    </div>

    <div id="searchModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h2>
                <button class="close-btn" onclick="closeSearch()">âœ•</button>
            </div>
            <input type="text" class="search-input" id="searchInput" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¢ÙŠØ§Øª ÙˆØ§Ù„ØªÙØ³ÙŠØ±..." oninput="handleSearch()">
            <div id="searchResults" class="search-results"></div>
        </div>
    </div>

    <div id="fihrisModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ÙÙ‡Ø±Ø³ Ø§Ù„Ø³ÙˆØ±</h2>
                <button class="close-btn" onclick="closeFihris()">âœ•</button>
            </div>
            <div id="suraList" class="sura-grid"></div>
        </div>
    </div>

    <div class="container">
        <div id="loadingDiv" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…...</div>
        
        <div id="mainContent" style="display:none;">
            <div class="progress-bar">
                <div class="progress-info">
                    <span id="progressText">Ø§Ù„Ø¢ÙŠØ© 1 Ù…Ù† 6236</span>
                    <span id="progressPercent">0%</span>
                </div>
                <div class="progress-track">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
            </div>

            <div class="card verse-card">
                <div class="card-header">
                    <div class="card-icon verse-icon">ğŸ“–</div>
                    <h2 class="card-title" style="color: #047857;">Ø§Ù„Ø¢ÙŠØ© Ø§Ù„ÙƒØ±ÙŠÙ…Ø©</h2>
                </div>
                <div class="content-box">
                    <p class="verse-text" id="verseText">Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„ÙÙ‘Ù‡Ù Ù±Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…Ù</p>
                </div>
            </div>

            <div class="card tafsir-card">
                <div class="card-header">
                    <div class="card-icon tafsir-icon">Øª</div>
                    <h2 class="card-title" style="color: #d97706;">Ø§Ù„ØªÙØ³ÙŠØ±</h2>
                </div>
                <div class="content-box">
                    <p class="tafsir-text" id="tafsirText">ØªÙØ³ÙŠØ± Ø§Ù„Ø¢ÙŠØ©...</p>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="nav-btn btn-prev" id="prevBtn" onclick="goPrevious()">
                    <span>â—„</span>
                    <span>Ø§Ù„Ø³Ø§Ø¨Ù‚</span>
                </button>
                <button class="nav-btn btn-share" onclick="shareVerse()">
                    <span>â†—</span>
                    <span>Ù…Ø´Ø§Ø±ÙƒØ©</span>
                </button>
                <button class="nav-btn btn-next" id="nextBtn" onclick="goNext()">
                    <span>Ø§Ù„ØªØ§Ù„ÙŠ</span>
                    <span>â–º</span>
                </button>
            </div>

            <div class="dedication">
                <p class="dedication-text">Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…Ù„ ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© Ø¹Ù†ÙŠ ÙˆØ¹Ù† ÙˆØ§Ù„Ø¯ÙŠÙ‘ ÙˆØ²ÙˆØ¬ØªÙŠ ÙˆØ£ÙˆÙ„Ø§Ø¯ÙŠ</p>
                <p class="dedication-sub">ï·² ÙŠØªÙ‚Ø¨Ù„ Ù…Ù†Ø§ ÙˆÙ…Ù†ÙƒÙ… ØµØ§Ù„Ø­ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„</p>
            </div>

            <div class="footer">
                <p class="footer-name">ØªØµÙ…ÙŠÙ… ÙˆØªÙ†ÙÙŠØ° Ø£ / Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠ</p>
                <p class="footer-copyright">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2026</p>
            </div>
        </div>
    </div>

    <script>
        let quranData = [];
        let currentIndex = 0;
        let suraList = [];

        async function loadData() {
            try {
                const response = await fetch('quran.json');
                const data = await response.json();
                
                quranData = data.data.map((verse, idx) => ({
                    text: verse.text,
                    translation: verse.translation || '',
                    suraNumber: verse.sura,
                    suraName: verse.sura_name,
                    ayahNumber: verse.aya,
                    index: idx
                }));
                
                console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ ' + quranData.length + ' Ø¢ÙŠØ©');
                
                extractSuraList();
                
                const savedIndex = parseInt(localStorage.getItem('lastReadIndex') || '0');
                currentIndex = savedIndex < quranData.length ? savedIndex : 0;
                
                document.getElementById('loadingDiv').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                
                updateDisplay();
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„:', error);
                document.getElementById('loadingDiv').innerHTML = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„: ' + error.message + '<br>ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ù„Ù quran.json';
            }
        }

        function extractSuraList() {
            const suras = [];
            const seenSuras = new Set();
            
            quranData.forEach(verse => {
                if (!seenSuras.has(verse.suraNumber)) {
                    seenSuras.add(verse.suraNumber);
                    const suraVerses = quranData.filter(v => v.suraNumber === verse.suraNumber);
                    suras.push({
                        number: verse.suraNumber,
                        name: verse.suraName,
                        ayahCount: suraVerses.length,
                        firstIndex: verse.index
                    });
                }
            });
            
            suraList = suras;
            displaySuraList();
        }

        function displaySuraList() {
            const container = document.getElementById('suraList');
            container.innerHTML = suraList.map(sura => `
                <div class="sura-item" onclick="goToSura(${sura.firstIndex})">
                    <div class="sura-name">${sura.name}</div>
                    <div class="sura-info">
                        <span>ğŸ“– ${sura.number}</span>
                        <span>ğŸ“ ${sura.ayahCount}</span>
                    </div>
                </div>
            `).join('');
        }

        function updateDisplay() {
            if (currentIndex < 0 || currentIndex >= quranData.length) return;
            
            const verse = quranData[currentIndex];
            
            document.getElementById('verseText').textContent = verse.text;
            document.getElementById('tafsirText').textContent = verse.translation || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙØ³ÙŠØ±';
            document.getElementById('suraName').textContent = verse.suraName + ' - Ø§Ù„Ø¢ÙŠØ© ' + verse.ayahNumber;
            
            const percent = Math.round(((currentIndex + 1) / quranData.length) * 100);
            document.getElementById('progressText').textContent = 'Ø§Ù„Ø¢ÙŠØ© ' + (currentIndex + 1) + ' Ù…Ù† ' + quranData.length;
            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('progressFill').style.width = percent + '%';
            
            document.getElementById('prevBtn').disabled = currentIndex === 0;
            document.getElementById('nextBtn').disabled = currentIndex === quranData.length - 1;
            
            localStorage.setItem('lastReadIndex', currentIndex);
        }

        function goNext() {
            if (currentIndex < quranData.length - 1) {
                currentIndex++;
                updateDisplay();
            }
        }

        function goPrevious() {
            if (currentIndex > 0) {
                currentIndex--;
                updateDisplay();
            }
        }

        function shareVerse() {
            const verse = quranData[currentIndex];
            const text = verse.text + '\n\n' + verse.translation + '\n\nğŸ“± Ù…Ù† ØªØ·Ø¨ÙŠÙ‚: Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©';
            if (navigator.share) {
                navigator.share({ title: 'Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©', text: text });
            } else {
                navigator.clipboard.writeText(text).then(() => {
                    alert('âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø® Ù„Ù„Ø­Ø§ÙØ¸Ø©!');
                }).catch(() => {
                    alert('ğŸ“‹ Ø§Ù„Ù†Øµ:\n\n' + text);
                });
            }
        }

        function toggleSearch() { document.getElementById('searchModal').classList.add('active'); }
        function closeSearch() { document.getElementById('searchModal').classList.remove('active'); document.getElementById('searchInput').value = ''; document.getElementById('searchResults').innerHTML = ''; }
        function toggleFihris() { document.getElementById('fihrisModal').classList.add('active'); }
        function closeFihris() { document.getElementById('fihrisModal').classList.remove('active'); }

        function handleSearch() {
            const query = document.getElementById('searchInput').value.trim();
            const resultsContainer = document.getElementById('searchResults');
            
            if (!query) { resultsContainer.innerHTML = ''; return; }
            
            const results = quranData.filter(v => v.text.includes(query) || v.translation.includes(query));
            
            if (results.length === 0) {
                resultsContainer.innerHTML = '<p style="text-align:center;color:#6b7280;padding:20px;font-size:14px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø¨Ø­Ø«</p>';
                return;
            }
            
            resultsContainer.innerHTML = '<p style="margin-bottom:10px;color:#6b7280;font-size:12px;font-weight:600;">Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ' + results.length + '</p>' + 
                results.slice(0, 50).map(result => `
                    <div class="search-result-item" onclick="goToVerse(${result.index})">
                        <div class="result-verse">${result.text.substring(0, 60)}...</div>
                        <div class="result-tafsir">${result.translation.substring(0, 70)}...</div>
                    </div>
                `).join('');
        }

        function goToVerse(index) { currentIndex = index; updateDisplay(); closeSearch(); }
        function goToSura(index) { currentIndex = index; updateDisplay(); closeFihris(); }

        loadData();
    </script>
</body>
</html>
