<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ© - ØªØ·Ø¨ÙŠÙ‚ Ù‚Ø±Ø¢Ù†ÙŠ</title>
    
    <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©" />
    <meta property="og:description" content="ØªØ·Ø¨ÙŠÙ‚ Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø¢ÙŠØ§Øª Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… Ù…Ø¹ Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø±" />
    
    <!-- Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© (React + Tailwind) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Ø®Ø·ÙˆØ· Ø¹Ø±Ø¨ÙŠØ© Ø¬Ù…ÙŠÙ„Ø© -->
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@600;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Cairo', sans-serif; }
        .font-quran { font-family: 'Amiri', serif; line-height: 2.5; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        function App() {
            const [surahs, setSurahs] = useState([]);
            const [tafseerData, setTafseerData] = useState([]);
            const [selectedSurah, setSelectedSurah] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState('');

            // Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ù…Ù† Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ù…Ù„)
            const URLS = {
                quran: 'https://kelgohary71-cyber.github.io/my-quran-app/quran.json',
                tafseer: 'https://kelgohary71-cyber.github.io/my-quran-app/tafseer.json'
            };

            useEffect(() => {
                loadData();
            }, []);

            const loadData = async () => {
                try {
                    setLoading(true);
                    setError('');

                    const [qRes, tRes] = await Promise.all([
                        fetch(URLS.quran),
                        fetch(URLS.tafseer)
                    ]);

                    if (!qRes.ok || !tRes.ok) throw new Error('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…');

                    const qJson = await qRes.json();
                    const tJson = await tRes.json();

                    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù…Ø±ÙˆÙ†Ø© (Ø³ÙˆØ§Ø¡ ÙƒØ§Ù†Øª Ø¯Ø§Ø®Ù„ data Ø£Ùˆ Ù…Ø¨Ø§Ø´Ø±Ø©)
                    const qList = qJson.data?.surahs || qJson.surahs || qJson;
                    const tList = tJson.data?.surahs || tJson.surahs || tJson;

                    if (!Array.isArray(qList)) throw new Error('ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„ÙØ§Øª ØºÙŠØ± ØµØ­ÙŠØ­');

                    setSurahs(qList);
                    setTafseerData(tList);
                    setLoading(false);

                } catch (err) {
                    console.error(err);
                    setError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
                    setLoading(false);
                }
            };

            // Ø¯Ø§Ù„Ø© ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Øµ Ù„Ù„Ø¨Ø­Ø« (Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ´ÙƒÙŠÙ„)
            const normalizeText = (text) => {
                if (!text) return '';
                let clean = text.replace(/[\u064B-\u065F\u0670]/g, ''); // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ´ÙƒÙŠÙ„
                clean = clean.replace(/(Ø¢|Ø¥|Ø£)/g, 'Ø§');
                clean = clean.replace(/Ø©/g, 'Ù‡');
                clean = clean.replace(/Ù‰/g, 'ÙŠ');
                return clean.toLowerCase().trim();
            };

            // ØªØµÙÙŠØ© Ø§Ù„Ø³ÙˆØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø­Ø«
            const filteredSurahs = useMemo(() => {
                if (!searchQuery) return surahs;
                const query = normalizeText(searchQuery);

                return surahs.filter(surah => {
                    const nameMatch = normalizeText(surah.name).includes(query);
                    const numMatch = surah.number.toString().includes(query);
                    // Ø§Ù„Ø¨Ø­Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¢ÙŠØ§Øª Ø£ÙŠØ¶Ø§Ù‹
                    const ayahMatch = surah.ayahs?.some(ayah => normalizeText(ayah.text).includes(query));
                    
                    return nameMatch || numMatch || ayahMatch;
                });
            }, [surahs, searchQuery]);

            // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
            const shareOnFacebook = (text) => {
                const url = encodeURIComponent(window.location.href);
                const quote = encodeURIComponent(text + '\n\nØªØ·Ø¨ÙŠÙ‚ Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©');
                window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${quote}`, '_blank');
            };

            const shareOnWhatsApp = (text) => {
                const msg = encodeURIComponent(text + '\n\nÙ…Ù† ØªØ·Ø¨ÙŠÙ‚: Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©\n' + window.location.href);
                window.open(`https://wa.me/?text=${msg}`, '_blank');
            };

            const shareOnTwitter = (text) => {
                const msg = encodeURIComponent(text + '\n\nØªØ·Ø¨ÙŠÙ‚ Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©');
                window.open(`https://twitter.com/intent/tweet?text=${msg}&url=${window.location.href}`, '_blank');
            };

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text).then(() => {
                    alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¢ÙŠØ©');
                });
            };

            // Ø¯Ø§Ù„Ø© Ù„Ø¬Ù„Ø¨ ØªÙØ³ÙŠØ± Ø¢ÙŠØ© Ù…Ø­Ø¯Ø¯Ø©
            const getTafseer = (surahNum, ayahNum) => {
                if (!tafseerData.length) return 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...';
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø³ÙˆØ±Ø© ÙÙŠ Ù…Ù„Ù Ø§Ù„ØªÙØ³ÙŠØ±
                const surahTafseer = tafseerData.find(s => s.number === surahNum);
                if (!surahTafseer) return 'Ø§Ù„ØªÙØ³ÙŠØ± ØºÙŠØ± Ù…ØªÙˆÙØ± Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙˆØ±Ø©';

                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¢ÙŠØ© (ayahs Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø§Ø³Ù…Ù‡ verses ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ù„ÙØ§Øª Ù„Ø°Ø§ Ù†ÙØ­Øµ Ø§Ù„Ø§Ø«Ù†ÙŠÙ†)
                const ayahsList = surahTafseer.ayahs || surahTafseer.verses || [];
                const ayahTafseer = ayahsList.find(a => (a.numberInSurah || a.id) === ayahNum);

                return ayahTafseer ? ayahTafseer.text : 'Ø§Ù„ØªÙØ³ÙŠØ± ØºÙŠØ± Ù…ØªÙˆÙØ± Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø¢ÙŠØ©';
            };

            // --- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ---
            if (loading) {
                return (
                    <div className="min-h-screen bg-emerald-50 flex flex-col items-center justify-center p-4">
                        <div className="animate-spin rounded-full h-16 w-16 border-b-4 border-emerald-600 mb-4"></div>
                        <p className="text-xl text-emerald-800 font-bold">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØµØ­Ù Ø§Ù„Ø´Ø±ÙŠÙ...</p>
                    </div>
                );
            }

            // --- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø®Ø·Ø£ ---
            if (error) {
                return (
                    <div className="min-h-screen flex items-center justify-center p-4 bg-red-50">
                        <div className="bg-white p-8 rounded-2xl shadow-xl text-center max-w-md">
                            <div className="text-5xl mb-4">âš ï¸</div>
                            <h2 className="text-2xl font-bold text-red-600 mb-2">Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£</h2>
                            <p className="text-gray-600 mb-6">{error}</p>
                            <button onClick={loadData} className="bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 transition">
                                Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50 pb-12">
                    {/* Header */}
                    <header className="bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-6 shadow-lg sticky top-0 z-50">
                        <div className="container mx-auto px-4 text-center">
                            <h1 className="text-3xl font-extrabold mb-1 drop-shadow-md">ğŸ“– Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©</h1>
                            <p className="text-emerald-100 text-sm">ØªØ·Ø¨ÙŠÙ‚ Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆÙ…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ… Ù…Ø¹ Ø§Ù„ØªÙØ³ÙŠØ±</p>
                        </div>
                    </header>

                    <div className="container mx-auto px-4 py-8 max-w-5xl">
                        
                        {/* Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø³ÙˆØ±Ø©ØŒ Ø§Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆØ§Ù„Ø¨Ø­Ø« */}
                        {!selectedSurah ? (
                            <div className="animate-fade-in-up">
                                {/* Search Bar */}
                                <div className="mb-8 relative max-w-xl mx-auto">
                                    <input
                                        type="text"
                                        placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ±Ø© Ø£Ùˆ Ø¨ÙƒÙ„Ù…Ø© Ù…Ù† Ø¢ÙŠØ©..."
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                        className="w-full px-5 py-4 pl-12 rounded-2xl border-2 border-emerald-100 focus:border-emerald-500 focus:outline-none shadow-md text-lg transition-all"
                                    />
                                    <span className="absolute left-4 top-1/2 transform -translate-y-1/2 text-2xl">ğŸ”</span>
                                </div>

                                {/* Grid of Surahs */}
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
                                    {filteredSurahs.map((surah) => (
                                        <div
                                            key={surah.number}
                                            onClick={() => setSelectedSurah(surah)}
                                            className="bg-white p-5 rounded-2xl shadow-md hover:shadow-xl hover:-translate-y-1 transition-all cursor-pointer border border-emerald-50 group"
                                        >
                                            <div className="flex items-center justify-between">
                                                <div className="flex items-center gap-4">
                                                    <div className="w-12 h-12 rounded-full bg-emerald-100 text-emerald-700 flex items-center justify-center font-bold text-lg group-hover:bg-emerald-600 group-hover:text-white transition-colors">
                                                        {surah.number}
                                                    </div>
                                                    <div>
                                                        <h3 className="text-xl font-bold text-gray-800">{surah.name}</h3>
                                                        <p className="text-sm text-gray-500">{surah.englishName}</p>
                                                    </div>
                                                </div>
                                                <div className="text-xs font-semibold px-3 py-1 rounded-full bg-gray-100 text-gray-600">
                                                    {surah.numberOfAyahs} Ø¢ÙŠØ©
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                
                                {filteredSurahs.length === 0 && (
                                    <div className="text-center py-10 text-gray-500">
                                        Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«
                                    </div>
                                )}
                            </div>
                        ) : (
                            /* Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³ÙˆØ±Ø© */
                            <div className="animate-fade-in">
                                <button
                                    onClick={() => setSelectedSurah(null)}
                                    className="mb-6 flex items-center gap-2 text-emerald-700 font-bold hover:bg-emerald-100 px-4 py-2 rounded-lg transition-colors bg-white shadow-sm"
                                >
                                    â¡ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙÙ‡Ø±Ø³
                                </button>

                                <div className="bg-white rounded-3xl shadow-xl overflow-hidden mb-8 border border-emerald-100">
                                    <div className="bg-gradient-to-r from-emerald-600 to-teal-600 p-8 text-center text-white">
                                        <h2 className="text-4xl font-bold mb-2 font-quran">{selectedSurah.name}</h2>
                                        <div className="flex justify-center gap-4 text-emerald-100 text-sm">
                                            <span>{selectedSurah.revelationType === 'Meccan' ? 'Ù…ÙƒÙŠØ©' : 'Ù…Ø¯Ù†ÙŠØ©'}</span>
                                            <span>â€¢</span>
                                            <span>{selectedSurah.numberOfAyahs} Ø¢ÙŠØ©</span>
                                        </div>
                                    </div>

                                    <div className="p-4 md:p-8 space-y-8">
                                        {/* Ø§Ù„Ø¨Ø³Ù…Ù„Ø© (Ø¥Ù„Ø§ ÙÙŠ Ø§Ù„ØªÙˆØ¨Ø© Ø±Ù‚Ù… 9) */}
                                        {selectedSurah.number !== 9 && (
                                            <div className="text-center text-2xl font-quran text-emerald-800 mb-8">
                                                Ø¨ÙØ³Ù’Ù…Ù Ù±Ù„Ù„Ù‘ÙÙ‡Ù Ù±Ù„Ø±Ù‘ÙØ­Ù’Ù…ÙÙ°Ù†Ù Ù±Ù„Ø±Ù‘ÙØ­ÙÙŠÙ…Ù
                                            </div>
                                        )}

                                        {selectedSurah.ayahs?.map((ayah) => (
                                            <div key={ayah.number} className="border-b border-gray-100 pb-8 last:border-0">
                                                {/* Ø§Ù„Ø¢ÙŠØ© */}
                                                <div className="mb-6 relative">
                                                    <span className="inline-block text-xs bg-emerald-100 text-emerald-800 px-2 py-1 rounded mb-2">
                                                        Ø¢ÙŠØ© {ayah.numberInSurah}
                                                    </span>
                                                    <p className="text-3xl md:text-4xl text-right leading-loose font-quran text-gray-800" dir="rtl">
                                                        {ayah.text}
                                                    </p>
                                                </div>

                                                {/* Ø§Ù„ØªÙØ³ÙŠØ± */}
                                                <div className="bg-slate-50 rounded-xl p-5 mb-4 border-r-4 border-blue-400">
                                                    <h4 className="text-blue-600 font-bold mb-2 text-sm flex items-center gap-2">
                                                        <span>ğŸ“š</span> Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø±:
                                                    </h4>
                                                    <p className="text-gray-700 leading-relaxed text-lg">
                                                        {getTafseer(selectedSurah.number, ayah.numberInSurah)}
                                                    </p>
                                                </div>

                                                {/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© */}
                                                <div className="flex flex-wrap gap-3 justify-end">
                                                    <button onClick={() => shareOnFacebook(ayah.text)} className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm font-bold shadow-sm hover:shadow-md">
                                                        <span>ÙÙŠØ³Ø¨ÙˆÙƒ</span>
                                                    </button>
                                                    <button onClick={() => shareOnWhatsApp(ayah.text)} className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition text-sm font-bold shadow-sm hover:shadow-md">
                                                        <span>ÙˆØ§ØªØ³Ø§Ø¨</span>
                                                    </button>
                                                    <button onClick={() => shareOnTwitter(ayah.text)} className="flex items-center gap-2 px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600 transition text-sm font-bold shadow-sm hover:shadow-md">
                                                        <span>ØªÙˆÙŠØªØ±</span>
                                                    </button>
                                                    <button onClick={() => copyToClipboard(ayah.text)} className="flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition text-sm font-bold shadow-sm hover:shadow-md">
                                                        <span>Ù†Ø³Ø® Ø§Ù„Ù†Øµ</span>
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Footer */}
                    <footer className="bg-emerald-800 text-white py-8 text-center mt-auto">
                        <p className="font-bold text-lg mb-2">ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© Ø¹Ù†ÙŠ ÙˆØ¹Ù† ÙˆØ§Ù„Ø¯ÙŠÙ‘Ø§ ÙˆØ²ÙˆØ¬ØªÙŠ ÙˆØ£ÙˆÙ„Ø§Ø¯ÙŠ</p>
                        <p className="text-emerald-300 text-sm">ØªØµÙ…ÙŠÙ… ÙˆØªØ·ÙˆÙŠØ±: Ø£ / Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠ Â© 2025</p>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
    
    <style>
        /* Ø¥Ø¶Ø§ÙØ© Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø© */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out; }
        .animate-fade-in { animation: fadeInUp 0.3s ease-out; }
    </style>
</body>
</html>