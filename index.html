<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ© - Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri+Quran&family=Cairo:wght@900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Cairo', sans-serif; 
            background: linear-gradient(135deg, #d1fae5 0%, #fef3c7 50%, #d1fae5 100%); 
            min-height: 100vh; padding-bottom: 30px;
        }
        
        .progress-header { 
            background: #065f46; color: #fbbf24; padding: 10px 15px; 
            text-align: center; position: sticky; top: 0; z-index: 1000;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); border-bottom: 3px solid #fbbf24;
        }
        .header-main { display: flex; align-items: center; justify-content: center; gap: 15px; }
        .app-logo { width: 55px; height: 55px; border-radius: 10px; border: 2px solid #fbbf24; object-fit: cover; }
        .progress-info { font-size: 20px; font-weight: 900; }

        .progress-bar-bg { background: #047857; height: 14px; border-radius: 7px; width: 85%; margin: 5px auto; overflow: hidden; border: 1px solid #fbbf24; }
        #progress-fill { background: #fbbf24; height: 100%; width: 0%; transition: width 0.5s; }

        .container { max-width: 800px; margin: 0 auto; padding: 15px; }

        .section-header { 
            font-size: 18px; font-weight: 900; padding: 8px 20px; border-radius: 15px 15px 0 0; 
            display: inline-block; margin-top: 10px; color: white;
        }
        .bg-quran { background: #10b981; }
        .bg-tafseer { background: #3b82f6; }

        .scroll-box { 
            background: white; border-radius: 0 15px 15px 15px; 
            padding: 20px; height: 350px; overflow-y: auto; margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-width: 4px; border-style: solid;
        }
        .quran-box { border-color: #10b981; background: #f0fff4; }
        .tafseer-box { border-color: #3b82f6; }

        .quran-text { font-family: 'Amiri Quran', serif; font-size: 28px; line-height: 2; text-align: center; color: #1f2937; }
        .tafseer-text { font-size: 22px; font-weight: 800; color: #374151; line-height: 1.6; text-align: justify; }

        .share-btn {
            background: #3b82f6; color: white; border: none; padding: 15px; 
            border-radius: 12px; font-weight: 900; cursor: pointer; width: 100%; 
            font-size: 20px; margin-bottom: 20px;
        }

        .nav-buttons { display: flex; gap: 15px; margin: 10px 0; }
        .nav-btn { flex: 1; padding: 22px; border: none; border-radius: 15px; font-size: 24px; font-weight: 900; color: white; cursor: pointer; }
        .btn-prev { background: #FF6B35; }
        .btn-next { background: #8B5CF6; border-bottom: 5px solid #5b21b6; }

        .dedication { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: 4px solid #fbbf24; border-radius: 15px; padding: 25px; text-align: center; color: white; margin-top: 30px; font-size: 20px; font-weight: 900; }
        .footer { background: #047857; padding: 20px; text-align: center; color: white; border-radius: 12px; margin-top: 15px; font-size: 24px; font-weight: 900; }
    </style>
</head>
<body>

    <div class="progress-header">
        <div class="header-main">
            <img src="logo.png" alt="Ù„ÙˆØ¬Ùˆ" class="app-logo" onerror="this.style.display='none'">
            <div class="progress-info" id="day-counter">Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ...</div>
        </div>
        <div class="progress-bar-bg"><div id="progress-fill"></div></div>
        <div style="font-size: 14px; font-weight: 900; text-align:center" id="percent-text">0%</div>
    </div>

    <div class="container">
        <div class="section-header bg-quran">Ù†Øµ Ø§Ù„Ù€ 20 Ø¢ÙŠØ©:</div>
        <div class="scroll-box quran-box" id="q-box-scroll">
            <div id="quran-content" class="quran-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¢ÙŠØ§Øª...</div>
        </div>

        <div class="section-header bg-tafseer">Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø±:</div>
        <div class="scroll-box tafseer-box" id="t-box-scroll">
            <div id="tafseer-content" class="tafseer-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ³ÙŠØ±...</div>
        </div>

        <button class="share-btn" onclick="shareFullWird()">Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ±Ø¯ Ø§Ù„ÙŠÙˆÙ… ÙƒØ§Ù…Ù„Ø§Ù‹ ğŸ”—</button>

        <div class="nav-buttons">
            <button class="nav-btn btn-prev" onclick="changePage(-1)">Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
            <button class="nav-btn btn-next" onclick="changePage(1)">Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </div>

        <div class="dedication">ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© Ø¹Ù†ÙŠ ÙˆØ¹Ù† ÙˆØ§Ù„Ø¯ÙŠØ§ ÙˆØ²ÙˆØ¬ØªÙŠ ÙˆØ£ÙˆÙ„Ø§Ø¯ÙŠ</div>
        <div class="footer">Ø£ / Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¬ÙˆÙ‡Ø±ÙŠ</div>
    </div>

    <script>
        let allVerses = [];
        let tafseerData = [];
        let currentPage = 0;
        const pageSize = 20;

        async function init() {
            try {
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù†
                const quranResponse = await fetch('quran.json');
                const suras = await quranResponse.json();
                
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø³ÙˆØ± Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¢ÙŠØ§Øª
                suras.forEach(sura => {
                    sura.verses.forEach(verse => {
                        allVerses.push({
                            text: verse.text,
                            suraNumber: sura.id,
                            suraName: sura.name,
                            verseNumber: verse.id
                        });
                    });
                });

                console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ ' + allVerses.length + ' Ø¢ÙŠØ© Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù†');

                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ³ÙŠØ±
                const tafseerResponse = await fetch('tafseer.json');
                tafseerData = await tafseerResponse.json();
                
                console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ ' + tafseerData.length + ' ØªÙØ³ÙŠØ±');

                currentPage = parseInt(localStorage.getItem('currentWirdPage') || '0');
                render();
            } catch (e) {
                console.error('Ø®Ø·Ø£:', e);
                document.getElementById('quran-content').innerHTML = "<span style='color:red'>Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„ÙØ§Øª. ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¹ quran.json Ùˆ tafseer.json</span>";
            }
        }

        function render() {
            const qBox = document.getElementById('quran-content');
            const tBox = document.getElementById('tafseer-content');
            
            let qHTML = "";
            let tHTML = "";

            const start = currentPage * pageSize;
            const currentSet = allVerses.slice(start, start + pageSize);

            currentSet.forEach(verse => {
                // Ù†Øµ Ø§Ù„Ø¢ÙŠØ©
                qHTML += `<span>${verse.text}</span> <span style="color:#065f46; font-size:18px;">(${verse.suraName} - ${verse.verseNumber})</span> <br><br>`;
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚
                const tafseer = tafseerData.find(t => 
                    parseInt(t.number) === verse.suraNumber && 
                    parseInt(t.aya) === verse.verseNumber
                );
                
                if (tafseer) {
                    tHTML += `<p style="margin-bottom:15px; border-bottom:1px solid #eee; padding-bottom:10px;"><strong>${verse.suraName} - Ø¢ÙŠØ© ${verse.verseNumber}:</strong><br>${tafseer.text}</p>`;
                } else {
                    tHTML += `<p style="margin-bottom:15px; border-bottom:1px solid #eee; padding-bottom:10px;"><strong>${verse.suraName} - Ø¢ÙŠØ© ${verse.verseNumber}:</strong><br>Ø§Ù„ØªÙØ³ÙŠØ± ØºÙŠØ± Ù…ØªÙˆÙØ±</p>`;
                }
            });

            qBox.innerHTML = qHTML;
            tBox.innerHTML = tHTML;

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„Ù†Ø³Ø¨Ø©
            const totalPages = Math.ceil(allVerses.length / pageSize);
            const progress = totalPages > 1 ? ((currentPage / (totalPages - 1)) * 100).toFixed(1) : 100;
            
            document.getElementById('day-counter').innerText = `Ø§Ù„ÙˆØ±Ø¯ ${currentPage + 1} Ù…Ù† ${totalPages}`;
            document.getElementById('progress-fill').style.width = progress + "%";
            document.getElementById('percent-text').innerText = `Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø®ØªÙ…Ø©: ${progress}%`;

            // Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØªØµÙÙŠØ± Ø§Ù„Ø³ÙƒØ±ÙˆÙ„
            localStorage.setItem('currentWirdPage', currentPage);
            document.getElementById('q-box-scroll').scrollTop = 0;
            document.getElementById('t-box-scroll').scrollTop = 0;
        }

        function changePage(dir) {
            const totalPages = Math.ceil(allVerses.length / pageSize);
            const newPage = currentPage + dir;
            if (newPage >= 0 && newPage < totalPages) {
                currentPage = newPage;
                render();
            }
        }

        function shareFullWird() {
            const textToShare = `ÙˆØ±Ø¯ Ø§Ù„ÙŠÙˆÙ… Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Ø¨Ù„ØºÙˆØ§ Ø¹Ù†ÙŠ ÙˆÙ„Ùˆ Ø¢ÙŠØ©\nØ§Ù„ÙˆØ±Ø¯ Ø±Ù‚Ù… ${currentPage + 1}\n${window.location.href}`;
            if (navigator.share) {
                navigator.share({ title: 'ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù†', text: textToShare });
            } else {
                navigator.clipboard.writeText(textToShare).then(() => {
                    alert("âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®!");
                }).catch(() => {
                    alert("Ø§Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·:\n" + window.location.href);
                });
            }
        }

        init();
    </script>
</body>
</html>
